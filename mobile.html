<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>åäººå¡è½¦åä¼šè‹±è¯­è¯„ä¼°è®­ç»ƒ Â· æ‰‹æœºç‰ˆ</title>
<style>
  :root{--bg:#0b1220;--card:#0f1b2e;--line:#1f2a44;--text:#e6eef9;--muted:#9fb1c9}
  *{box-sizing:border-box}
  body{margin:0;background:#0b1220;color:var(--text);font:14px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  header{position:sticky;top:0;z-index:10;background:#0f1b2e;border-bottom:1px solid var(--line)}
  .wrap{max-width:800px;margin:0 auto;padding:0 12px}
  .h-bar{display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap;padding:10px 0}
  h1{font-size:15px;margin:0;flex:1 0 100%}
  input[type="search"]{flex:1;border:1px solid var(--line);background:#0b1629;color:var(--text);padding:8px;border-radius:8px;min-width:140px}
  select.btn{padding:6px 8px;background:#10213a;border:1px solid var(--line);color:var(--text);border-radius:8px}
  .slider-wrap{display:flex;align-items:center;gap:4px}
  .slider-wrap input[type="range"]{width:100px}
  main{padding:14px 0 40px}
  section{margin:14px 0}
  h2{font-size:17px;margin:0 0 6px}
  .small{font-size:12px;color:var(--muted)}
  table{width:100%;border-collapse:collapse;background:#0f1b2e;border:1px solid var(--line);border-radius:12px;overflow:hidden;table-layout:auto;word-break:break-word}
  th,td{padding:8px;border-bottom:1px solid #1a2948;vertical-align:top}
  th{background:#0e1a31;text-align:left;font-weight:600}
  tr:last-child td{border-bottom:none}
  tbody td:last-child{text-align:center;white-space:nowrap}
  .btn{border:1px solid var(--line);background:#10213a;color:var(--text);padding:4px 8px;border-radius:8px;cursor:pointer}
  .hint{color:var(--muted);font-size:12px}
</style>
</head>
<body>
<header>
  <div class="wrap h-bar">
    <h1>åäººå¡è½¦åä¼šè‹±è¯­è¯„ä¼°è®­ç»ƒ Â· æ‰‹æœºç‰ˆ</h1>
    <input id="globalSearch" type="search" placeholder="æœç´¢â€¦" oninput="filterAllTables()">
    <select id="voiceSel" class="btn"><option>åŠ è½½è¯­éŸ³ä¸­â€¦</option></select>
    <div class="slider-wrap">
      <label class="small" for="rateCtl">é€Ÿ <span id="rateOut">0.95</span></label>
      <input id="rateCtl" type="range" min="0.6" max="1.4" step="0.05" value="0.95" />
    </div>
  </div>
</header>

<main class="wrap">
  <section id="essential">
    <h2>å¿…å¤‡è¯ä»¶ä¸å•æ®</h2>
    <table id="tblEssential"><thead><tr><th>è‹±æ–‡</th><th>ä¸­æ–‡</th><th>è¯»éŸ³</th><th>ğŸ”Š</th></tr></thead><tbody></tbody></table>
  </section>
  <section id="states">
    <h2>ç¾å›½å„å·</h2>
    <table id="tblStates"><thead><tr><th>State</th><th>ä¸­æ–‡</th><th>è¯»éŸ³</th><th>ğŸ”Š</th></tr></thead><tbody></tbody></table>
  </section>
</main>

<script src="data.js"></script>
<script src="common.js"></script>
<script>
function safeArr(a){return Array.isArray(a)?a:[];}

function renderRows(tbody, rows){
  tbody.innerHTML='';
  rows.forEach(r=>{
    tbody.insertAdjacentHTML('beforeend',`
      <tr>
        <td>${r.en||''}</td>
        <td>${r.cn||''}</td>
        <td class="hint">${r.pr||''}</td>
        <td><button class="btn" onclick="speakText(\`${(r.en||'').replace(/`/g,'\\`')}\`)">ğŸ”Š</button></td>
      </tr>`);
  });
}

function initTables(){
  renderRows(document.querySelector('#tblEssential tbody'), safeArr(window.essentialData));
  renderRows(document.querySelector('#tblStates tbody'), safeArr(window.statesData));
}

function filterAllTables(){
  const q=document.getElementById('globalSearch').value.trim().toLowerCase();
  document.querySelectorAll('table tbody tr').forEach(tr=>{
    const match=[...tr.cells].some(td=>(td.innerText||'').toLowerCase().includes(q));
    tr.style.display=match?'':'none';
  });
}

document.addEventListener('DOMContentLoaded',()=>{
  wireTtsControls('voiceSel','rateCtl','rateOut');
});

gatedInit(initTables);
</script>
</body>
</html>
